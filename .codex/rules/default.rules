prefix_rule(pattern=["npm", "--version"], decision="allow")
prefix_rule(pattern=["npm", "-g", "list", "@excalidraw/excalidraw-cli"], decision="allow")
prefix_rule(pattern=["scripts/list-curated-skills.py"], decision="allow")
prefix_rule(pattern=[".codex/skills/.system/skill-installer/scripts/list-curated-skills.py"], decision="allow")
prefix_rule(pattern=["python3", ".codex/skills/.system/skill-installer/scripts/list-curated-skills.py"], decision="allow")
prefix_rule(pattern=["gh", "auth", "login", "--hostname", "github.com", "--git-protocol", "https", "--web"], decision="allow")
prefix_rule(pattern=["gh", "api", "user", "--jq", ".login, .name, .email"], decision="allow")
prefix_rule(pattern=["gh", "api", "user/emails", "--jq", ".[0].email"], decision="allow")
prefix_rule(pattern=["gh", "repo", "create", "test-framework", "--private", "--source=.", "--remote=origin", "--push"], decision="allow")
prefix_rule(pattern=["gh", "repo", "view", "--json", "nameWithOwner,defaultBranchRef,visibility", "--jq", ".nameWithOwner + \"|\" + .defaultBranchRef.name + \"|\" + .visibility"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework/branches/main/protection"], decision="allow")
prefix_rule(pattern=["gh", "repo", "edit", "EdouardZemb/test-framework", "--visibility", "public", "--accept-visibility-change-consequences"], decision="allow")
prefix_rule(pattern=["gh", "repo", "view", "EdouardZemb/test-framework", "--json", "visibility,defaultBranchRef,url", "--jq", ".visibility + \"|\" + .defaultBranchRef.name + \"|\" + .url"], decision="allow")
prefix_rule(pattern=["gh", "secret", "list", "--repo", "EdouardZemb/test-framework"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "names=$(gh secret list --repo EdouardZemb/test-framework | awk 'NR>1 {print $1}'); missing=\"\"; for s in TEST_USER_EMAIL TEST_USER_PASSWORD OPENAI_API_KEY; do echo \"$names\" | grep -qx \"$s\" || missing=\"$missing $s\"; done; if [ -z \"$missing\" ]; then echo \"ALL_PRESENT\"; else echo \"MISSING:$missing\"; fi"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "names=$(gh secret list --repo EdouardZemb/test-framework | awk '{print $1}'); missing=\"\"; for s in TEST_USER_EMAIL TEST_USER_PASSWORD OPENAI_API_KEY; do echo \"$names\" | grep -qx \"$s\" || missing=\"$missing $s\"; done; if [ -z \"$missing\" ]; then echo \"ALL_PRESENT\"; else echo \"MISSING:$missing\"; fi"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework", "--jq", "{name: .full_name, description: .description, homepage: .homepage, topics: .topics, visibility: .visibility, default_branch: .default_branch, allow_merge_commit: .allow_merge_commit, allow_squash_merge: .allow_squash_merge, allow_rebase_merge: .allow_rebase_merge, delete_branch_on_merge: .delete_branch_on_merge, allow_auto_merge: .allow_auto_merge, allow_update_branch: .allow_update_branch, has_issues: .has_issues, has_wiki: .has_wiki, has_projects: .has_projects}"], decision="allow")
prefix_rule(pattern=["gh", "repo", "edit", "EdouardZemb/test-framework", "--description", "CLI for TRA QA process optimization: Jira/Squash triage, testability scoring, reporting automation, and privacy-first LLM assistance."], decision="allow")
prefix_rule(pattern=["gh", "api", "-X", "PUT", "repos/EdouardZemb/test-framework/topics", "-H", "Accept: application/vnd.github+json", "-f", "names[]=qa-automation", "-f", "names[]=cli-tool", "-f", "names[]=jira", "-f", "names[]=squash-tm", "-f", "names[]=testability", "-f", "names[]=reporting-automation", "-f", "names[]=llm", "-f", "names[]=privacy-by-design", "-f", "names[]=insuretech"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework", "--jq", "{description: .description, topics: .topics, allow_merge_commit: .allow_merge_commit, allow_squash_merge: .allow_squash_merge, allow_rebase_merge: .allow_rebase_merge, delete_branch_on_merge: .delete_branch_on_merge}"], decision="allow")
prefix_rule(pattern=["gh", "repo", "edit", "EdouardZemb/test-framework", "--enable-merge-commit=false", "--enable-rebase-merge=false", "--enable-squash-merge=true", "--delete-branch-on-merge", "--enable-auto-merge"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework", "--jq", "{allow_merge_commit: .allow_merge_commit, allow_rebase_merge: .allow_rebase_merge, allow_squash_merge: .allow_squash_merge, delete_branch_on_merge: .delete_branch_on_merge, allow_auto_merge: .allow_auto_merge}"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "gh api repos/EdouardZemb/test-framework/dependabot/alerts?state=open&per_page=100 --jq 'length'"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework", "--jq", "{private: .private, archived: .archived, has_issues: .has_issues, has_projects: .has_projects, has_wiki: .has_wiki, default_branch: .default_branch, security_and_analysis: .security_and_analysis}"], decision="allow")
prefix_rule(pattern=["gh", "api", "-i", "repos/EdouardZemb/test-framework/vulnerability-alerts"], decision="allow")
prefix_rule(pattern=["gh", "api", "-X", "PUT", "repos/EdouardZemb/test-framework/vulnerability-alerts"], decision="allow")
prefix_rule(pattern=["gh", "api", "-X", "PUT", "repos/EdouardZemb/test-framework/automated-security-fixes"], decision="allow")
prefix_rule(pattern=["gh", "repo", "edit", "EdouardZemb/test-framework", "--enable-secret-scanning", "--enable-secret-scanning-push-protection"], decision="allow")
prefix_rule(pattern=["gh", "api", "-X", "PATCH", "repos/EdouardZemb/test-framework/branches/main/protection/required_pull_request_reviews", "-F", "dismiss_stale_reviews=true", "-F", "require_code_owner_reviews=true", "-F", "required_approving_review_count=1"], decision="allow")
prefix_rule(pattern=["gh", "api", "-X", "PATCH", "repos/EdouardZemb/test-framework/branches/main/protection/required_status_checks", "-F", "strict=true", "-f", "contexts[]=Install Dependencies", "-f", "contexts[]=E2E Tests (Shard 1/4)", "-f", "contexts[]=E2E Tests (Shard 2/4)", "-f", "contexts[]=E2E Tests (Shard 3/4)", "-f", "contexts[]=E2E Tests (Shard 4/4)", "-f", "contexts[]=Merge Reports"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework", "--jq", "{security_and_analysis: .security_and_analysis, allow_auto_merge: .allow_auto_merge, delete_branch_on_merge: .delete_branch_on_merge}"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "CONTENT=$(printf '# Default owners for all files in this repository.\\n* @EdouardZemb\\n' | base64 -w0); gh api -X PUT repos/EdouardZemb/test-framework/contents/.github/CODEOWNERS -f message='chore(repo): add CODEOWNERS baseline' -f content=\"$CONTENT\" -f branch='main'"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "gh api repos/EdouardZemb/test-framework/branches/main/protection > /tmp/main-protection-before-relax.json"], decision="allow")
prefix_rule(pattern=["git", "push", "origin", "main"], decision="allow")
prefix_rule(pattern=["gh", "api", "repos/EdouardZemb/test-framework/contents/.github/CODEOWNERS", "--jq", ".sha"], decision="allow")
